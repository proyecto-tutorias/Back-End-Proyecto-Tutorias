<!DOCTYPE html>
<html xmlns:th="https://thymeleaf.org">

<head>
    <title>Listado de usuarios</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <link href="./css/style.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@100..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script src="./js/cargarNavbar.js"></script>
</head>

<body>
    <div>
        <div id="navbar"></div>
        <div class="contenedor-listado-tutorias">
            <div class="row">
                <div class="col-lg-12">
                    <!-- Listado tutorias -->
                    <h1 class="titulo-listado-tutoria">Listado de usuarios</h1>
                    <div class="listado-tutorias" th:if='${usuarios != null and !usuarios.empty}'>
                        <div class="mb-3 card rounded-0 border-end-0 border-top-0 border-bottom-0 border-start border-5" th:each='usuario, iterador : ${usuarios}' th:if='${usuario.login != ususesion.login && usuario.activo == 1}'>
                            <div class="card-body">
                                <div>
                                    <h5 class="card-title fw-bold">Usuario: <span th:text='${usuario.login}'></span></h5>
                                    <p class="card-text">Carrera: <span th:text='${carreras[usuario.id_carrera - 1].descripcion}'></span></p>
                                    <p class="card-text" th:text='${tipo[iterador.index]}'></p>
                                </div>
                                <div class="d-flex align-items-center gap-3 esp-card">
                                  
                                    <a th:data-id="${usuario.id_usuario}" onclick="enviar(this.getAttribute('data-id'))"><i class="bi bi-trash-fill icono-perfil-card"></i></a>
                                    <a th:href='@{/edicionUsuario?id={id}(id=${usuario.id_usuario})}' class="text-black"><i class="bi bi-pencil-square icono-perfil-card"></i></a>
                                  
                                    
                                </div>
                                <script th:inline="javascript">
                                   
                                    function enviar(id){
                                        

                                            fetch('desactivarUsuario?' + new URLSearchParams({ id : id }).toString(), {
                                                method: 'POST'
                                                
                                            }).then(function (response) {
                                                return response.text();
                                            }).then(function (data) {
                                                window.location.reload();   
                                            }).catch(function (err) {
                                                console.warn('Something went wrong.', err);
                                            });


                                            
                                     }
                                    
                                   
                                    
                                    
                                   
                                </script>
                            </div>
                        </div>
                       

                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>